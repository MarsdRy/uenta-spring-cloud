spring:
  application:
    name: uenta-registry-server
---
spring:
  # 指定profile=ha-east-1a
  profiles: ha-east-1a

server:
  port: 7070
  address: 0.0.0.0

eureka:
  server:
# EMERGENCY! EUREKA MAY BE INCORRECTLY CLAIMING INSTANCES ARE UP WHEN THEY'RE NOT. RENEWALS ARE LESSER THAN THRESHOLD AND HENCE THE INSTANCES ARE NOT BEING EXPIRED JUST TO BE SAFE.
#    enableSelfPreservation: false #设为false , 关闭自我保护
#    evictionIntervalTimerInMs: 4000 # 清理间隔（单位毫秒，默认是60*1000）
  instance:
    # 指定当profile=ha-east-1a时，主机名是master
    hostname: 192.168.0.164
    prefer-ip-address: true
    metadata-map:
      instanceId: ${spring.application.name}:${random.value}
#    leaseRenewalIntervalInSeconds: 10 #测试使用
#    leaseExpirationDurationInSeconds: 30 
  client:
    registerWithEureka: false   #测试使用 false
    fetchRegistry: false        #测试使用 false
    server:
      waitTimeInMsWhenSyncEmpty: 0
    serviceUrl:
      # 将自己注册到backup这个eureka上面去
      defaultZone: http://${security.user.name}:${security.user.password}@192.168.0.164:7071/eureka/
    healthcheck: #只应该在application.yml中设置。如果设置在bootstrap.yml中将会导致一些不良的副作用，例如在Eureka中注册的应用名称是UNKNOWN等。
      enabled: true

security:
  basic:
    enabled: true               # 开启基于HTTP basic的认证
  user:
    name: user                  # 配置登录的账号是user
    password: ${REGISTRY_SERVER_PASSWORD:password}       # 配置登录的密码是password

---
spring:
  # 指定profile=ha-east-1b
  profiles: ha-east-1b

server:
  port: 7071
  address: 0.0.0.0

eureka:
  server:
#    enableSelfPreservation: false #设为false , 关闭自我保护
#    evictionIntervalTimerInMs: 4000 # 清理间隔（单位毫秒，默认是60*1000）
  instance:
    # 指定当profile=ha-east-1b时，主机名是backup
    hostname: 192.168.0.164
    prefer-ip-address: true
    metadata-map:
      instanceId: ${spring.application.name}:${random.value}
#    leaseRenewalIntervalInSeconds: 10 #测试使用
#    leaseExpirationDurationInSeconds: 30
  client:
    registerWithEureka: false   #测试使用 false
    fetchRegistry: false        #测试使用 false
    server:
      waitTimeInMsWhenSyncEmpty: 0
    serviceUrl:
      defaultZone: http://${security.user.name}:${security.user.password}@192.168.0.164:7070/eureka/
    healthcheck: #只应该在application.yml中设置。如果设置在bootstrap.yml中将会导致一些不良的副作用，例如在Eureka中注册的应用名称是UNKNOWN等。
      enabled: true

security:
  basic:
    enabled: true               # 开启基于HTTP basic的认证
  user:
    name: user                  # 配置登录的账号是user
    password: ${REGISTRY_SERVER_PASSWORD:password}       # 配置登录的密码是password
